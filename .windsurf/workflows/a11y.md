---
description: Accessibility (a11y) audit — check ARIA attributes, keyboard navigation, color contrast, and screen reader compatibility.
---

## User Input

```text
$ARGUMENTS
```

You **MUST** consider the user input before proceeding (if not empty).

## Outline

1. **Parse Arguments**: Determine audit scope:
   - Component path or name
   - Page route
   - `--full` — Audit entire app
   - `--fix` — Auto-fix common issues
   - `--report` — Generate detailed report

2. **Automated Checks**:

   Search for common a11y issues in the codebase:

   ```bash
   # Images without alt text
   grep -rn "<img" --include="*.tsx" | grep -v "alt="

   # Buttons without accessible labels
   grep -rn "<button" --include="*.tsx" | grep -v "aria-label\|aria-labelledby\|children"

   # Click handlers on non-interactive elements
   grep -rn "onClick=" --include="*.tsx" | grep -E "<div|<span|<p" | grep -v "role=\|tabIndex="

   # Missing form labels
   grep -rn "<input\|<textarea\|<select" --include="*.tsx" | grep -v "aria-label\|id="

   # Empty links
   grep -rn "<a " --include="*.tsx" | grep -v "aria-label\|children"
   ```

3. **ARIA Attribute Audit**:

   **Required ARIA patterns**:

   | Component | Required ARIA |
   |-----------|--------------|
   | Dialog/Modal | `role="dialog"`, `aria-modal`, `aria-labelledby` |
   | Dropdown | `role="listbox"`, `aria-expanded`, `aria-haspopup` |
   | Tabs | `role="tablist"`, `role="tab"`, `role="tabpanel"` |
   | Alert | `role="alert"`, `aria-live="polite"` |
   | Navigation | `role="navigation"`, `aria-label` |
   | Search | `role="search"`, `aria-label` |
   | Toggle | `aria-pressed` or `aria-checked` |
   | Loading | `aria-busy="true"`, `aria-live="polite"` |

   **Check shadcn/Radix components**: These should have built-in a11y, but verify proper usage:

   ```typescript
   // Good: Dialog with proper labeling
   <Dialog>
     <DialogTrigger asChild>
       <Button>Open</Button>
     </DialogTrigger>
     <DialogContent>
       <DialogHeader>
         <DialogTitle>Title</DialogTitle>
         <DialogDescription>Description</DialogDescription>
       </DialogHeader>
     </DialogContent>
   </Dialog>
   ```

4. **Keyboard Navigation Audit**:

   **Check for**:
   - [ ] All interactive elements reachable via Tab
   - [ ] Focus visible indicator on all focusable elements
   - [ ] Escape key closes modals/dropdowns
   - [ ] Arrow keys navigate within components (tabs, menus)
   - [ ] Enter/Space activates buttons and links
   - [ ] No keyboard traps (focus can leave all components)
   - [ ] Skip navigation link for main content

   **Common fixes**:

   ```tsx
   // Add tabIndex for custom interactive elements
   <div
     role="button"
     tabIndex={0}
     onClick={handleClick}
     onKeyDown={(e) => {
       if (e.key === 'Enter' || e.key === ' ') {
         e.preventDefault()
         handleClick()
       }
     }}
   >
     Custom Button
   </div>

   // Focus management for modals
   useEffect(() => {
     if (isOpen) {
       dialogRef.current?.focus()
     }
   }, [isOpen])

   // Focus visible styles
   // Tailwind: focus-visible:ring-2 focus-visible:ring-ring
   ```

5. **Color Contrast Audit**:

   **WCAG AA Requirements**:

   | Element | Minimum Ratio |
   |---------|--------------|
   | Normal text (< 18px) | 4.5:1 |
   | Large text (>= 18px bold or >= 24px) | 3:1 |
   | UI components & graphics | 3:1 |

   **Check CSS variables** in `app/globals.css`:
   - `--foreground` vs `--background` contrast
   - `--muted-foreground` vs `--background` contrast
   - `--primary` vs `--primary-foreground` contrast
   - Verify both light and dark theme meet requirements

   **Common issues**:
   - Muted text too low contrast
   - Placeholder text insufficient contrast
   - Disabled state text too faint
   - Focus ring not visible on all backgrounds

6. **Screen Reader Compatibility**:

   **Check for**:
   - [ ] Meaningful page titles (`<title>` or `metadata.title`)
   - [ ] Heading hierarchy (h1 > h2 > h3, no skipping)
   - [ ] Alt text for all informative images
   - [ ] Decorative images have `alt=""`
   - [ ] Form inputs have associated labels
   - [ ] Error messages linked to inputs with `aria-describedby`
   - [ ] Live regions for dynamic content (`aria-live`)
   - [ ] Tables have headers (`<th>`) and captions

   ```tsx
   // Good: Form with proper labeling
   <div>
     <Label htmlFor="email">Email</Label>
     <Input
       id="email"
       type="email"
       aria-describedby="email-error"
       aria-invalid={!!error}
     />
     {error && (
       <p id="email-error" role="alert" className="text-destructive text-sm">
         {error}
       </p>
     )}
   </div>

   // Good: Dynamic content announcement
   <div aria-live="polite" aria-atomic="true">
     {statusMessage}
   </div>
   ```

7. **Motion & Animation**:

   ```tsx
   // Respect user's reduced motion preference
   const prefersReducedMotion = window.matchMedia(
     '(prefers-reduced-motion: reduce)'
   ).matches

   // Tailwind: motion-safe: and motion-reduce: variants
   <div className="motion-safe:animate-bounce motion-reduce:animate-none">
     Content
   </div>
   ```

8. **Generate Report**:

   ```markdown
   ## Accessibility Audit Report

   **Scope**: [Component/Page/Full App]
   **Date**: [Date]
   **Standard**: WCAG 2.1 AA

   ### Summary
   - Critical: X issues
   - Major: Y issues
   - Minor: Z issues

   ### Findings

   #### [CRITICAL] Missing form labels
   **Location**: `@/components/chat/chat-input.tsx:45`
   **Issue**: Input element without associated label
   **Fix**: Add `aria-label` or `<Label htmlFor="...">`

   #### [MAJOR] Keyboard trap in modal
   **Location**: `@/components/ui/dialog.tsx`
   **Issue**: Focus not trapped within modal when open
   **Fix**: Use Radix Dialog which handles focus trapping

   ### Recommendations
   1. Add skip navigation link
   2. Improve color contrast for muted text
   3. Add aria-live regions for AI response streaming
   ```

## Quick Fixes Reference

| Issue | Fix |
|-------|-----|
| Missing alt text | Add descriptive `alt` attribute |
| Non-interactive click handler | Add `role="button"` + `tabIndex={0}` + keyboard handler |
| Missing form label | Add `<Label htmlFor>` or `aria-label` |
| Low contrast text | Increase contrast ratio to 4.5:1 minimum |
| Missing focus indicator | Add `focus-visible:ring-2` |
| No heading structure | Use semantic headings (h1-h6) |
| Modal focus escape | Use Radix Dialog for built-in focus trap |

## Notes

- shadcn/Radix components provide solid a11y foundations — ensure proper usage
- Test with keyboard-only navigation regularly
- Use browser DevTools Accessibility panel for quick checks
- Consider screen reader testing with NVDA (Windows) or VoiceOver (macOS)
- Streaming AI responses should use `aria-live="polite"` for announcements
- Dark mode must maintain contrast ratios independently
