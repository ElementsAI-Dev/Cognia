# Cognia Project Development Rules

## Project Overview

Cognia is an AI-native chat and creation application with multi-provider support, built as a hybrid web/desktop application using Next.js 16+ and Tauri 2.9.

---

## MCP Tools - Active Usage Required

### Primary MCP Tools

When working on this project, **actively use these MCP tools**:

1. **ace-tool** (`mcp0_search_context`, `mcp0_enhance_prompt`)
   - **FIRST CHOICE** for codebase search
   - Use for semantic code understanding
   - Always query before making edits to understand context

2. **exa** (`mcp2_web_search_exa`, `mcp2_get_code_context_exa`, `mcp2_company_research_exa`)
   - Use for web search and documentation lookup
   - Get code examples from GitHub, Stack Overflow, official docs
   - Research libraries, APIs, and best practices

3. **deepwiki** (`mcp1_ask_question`, `mcp1_read_wiki_contents`, `mcp1_read_wiki_structure`)
   - Query GitHub repository documentation
   - Understand external library usage patterns
   - Get detailed project documentation

4. **perplexity-ask** (`mcp10_perplexity_ask`)
   - Complex research questions
   - Up-to-date technical information
   - Multi-source synthesis

5. **fetch** (`mcp3_fetch`)
   - Fetch URL content for documentation
   - Get latest API specs
   - Read online resources

### Search Strategy

1. **For codebase search**: Use `mcp0_search_context` first
2. **For external docs/APIs**: Use `mcp2_get_code_context_exa` or `mcp2_web_search_exa`
3. **For GitHub repos**: Use `mcp1_ask_question` with repo name
4. **For complex research**: Use `mcp10_perplexity_ask`

---

## Documentation References

### Internal Documentation

Read these files for project context:

- **`CLAUDE.md`** — Project overview, module structure, development commands
- **`AGENTS.md`** — Repository guidelines, coding standards, naming conventions
- **`llmdoc/index.md`** — Detailed feature documentation
- **`*/CLAUDE.md`** — Module-specific documentation in each major directory

### External Documentation

Use MCP tools to fetch:

- Next.js docs via `mcp8_nextjs_docs`
- Library documentation via `mcp3_fetch` or `mcp2_get_code_context_exa`
- GitHub repo docs via `mcp1_read_wiki_contents`

---

## Development Workflow

### Before Making Changes

1. **Search the codebase** using `mcp0_search_context`
2. **Read relevant files** to understand existing patterns
3. **Check external docs** if using unfamiliar APIs
4. **Follow existing patterns** in the codebase

### Code Quality

- Use `@/` path aliases for all imports
- Follow TypeScript strict mode
- Use `cn()` utility for Tailwind class merging
- Maintain test coverage for new features

### Testing

```bash
pnpm test           # Run unit tests
pnpm test:e2e       # Run E2E tests
pnpm lint           # Check code style
```

---

## Key Architectural Constraints

1. **Static Export**: Production builds use `output: "export"` — no server-side API routes
2. **Tauri Integration**: Desktop features require `isTauri()` guard
3. **Zustand Persistence**: All stores use localStorage via `persist` middleware
4. **MCP Servers**: Full system access — only trusted servers

---

## When Uncertain

- **Search first**: Use MCP tools to gather context
- **Read docs**: Check CLAUDE.md files in relevant directories
- **Web search**: Use exa or perplexity for external information
- **Ask user**: If still uncertain after research, ask for clarification
